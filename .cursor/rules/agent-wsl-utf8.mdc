---
alwaysApply: true
---
# Règle Agent: Exécution WSL sûre et UTF-8

Ces consignes s'appliquent à tous les appels d'Agent dans ce repo.

## Invariants d'exécution
- Toujours exécuter via WSL. Ne pas hériter du chemin Windows du workspace.
  - Préfixer chaque commande par: `wsl --cd ~ -e ...` (par défaut) ou `wsl -e ...`.
- Interdire les caractères non-ASCII dans les lignes de commande envoyées à l'Agent.
  - Pour produire du texte Unicode, utiliser soit des octets, soit des échappes bash `$'\uXXXX'`.
- Éviter les longues commandes chaînées par `;`/heredoc. Préférer des appels courts et séquentiels.

## Chemins et encodage
- Ne jamais passer un chemin Windows contenant des caractères spéciaux directement au shell.
- Construire les chemins côté WSL avec des échappes Unicode:
  - Exemple: `PATH_DIR=/mnt/d/Users/Strophe/Documents/$'\u00B0'IA/La\ Clique\ Qui\ Recycle/Recyclic`
  - Puis: `cd "$PATH_DIR"`

## Sortie Unicode sûre
- Exemple Python (octets UTF-8 purs):
  - `wsl -e python3 -c "import sys;sys.stdout.buffer.write(bytes([0xC3,0xA9,0x20,0xC3,0xA8,0x20,0xC3,0xA0,0x20,0xC3,0xA7,0x20,0xC3,0xB4,0x20,0xC2,0xB0,0x20,0xE2,0x82,0xAC,0x0A]))"`
- Exemple bash (échappes Unicode):
  - `wsl -e bash -lc "printf $'\\u00E9 \\u00E8 \\u00E0 \\u00E7 \\u00F4 \\u00B0 \\u20AC\\n'"`

## Locale WSL
- Utiliser la locale par défaut `C.UTF-8` (OK). Ne pas tenter `en_US.UTF-8` si non installée.

## Références repo
- Démarrage WSL/Docker: [start.sh](mdc:start.sh)
- Variables d'environnement: [env.example](mdc:env.example)
- Orchestration: [docker-compose.yml](mdc:docker-compose.yml)

